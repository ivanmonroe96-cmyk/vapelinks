---
import Layout from '../../layouts/Layout.astro';
import blogPosts from '../../data/blog-posts.json';

const sortedPosts = [...blogPosts].sort((a: any, b: any) => new Date(b.date).getTime() - new Date(a.date).getTime());

const categories = [...new Set(blogPosts.map((p: any) => p.category))];
---

<Layout title="Vaping Blog – Guides, Tips & Reviews | Vapelink Australia" description="Expert vaping guides, tips, product comparisons and news from Vapelink Australia. Everything you need to know about vaping.">
  <Fragment slot="head">
    <meta name="keywords" content="vaping blog, vape guide australia, vaping tips, e-liquid guide, vape maintenance, vape coil guide, sub ohm vaping, Vapelink blog" />
  </Fragment>

  <!-- Breadcrumb -->
  <nav class="breadcrumb-bar">
    <div class="container">
      <ol class="breadcrumb">
        <li><a href="/">Home</a></li>
        <li><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m9 18 6-6-6-6"/></svg></li>
        <li><span class="breadcrumb-current">Blog</span></li>
      </ol>
    </div>
  </nav>

  <!-- Hero -->
  <section class="blog-hero">
    <div class="container">
      <span class="section-label">Vapelink Blog</span>
      <h1 class="font-display blog-hero-title">Guides, Tips & Reviews</h1>
      <p class="blog-hero-desc">Expert advice and helpful guides for vapers of all experience levels.</p>
    </div>
  </section>

  <!-- Category Filter -->
  <section class="container blog-filter-section">
    <div class="blog-filters">
      <button class="blog-filter-btn active" data-category="all">All</button>
      {categories.map((cat: any) => (
        <button class="blog-filter-btn" data-category={cat}>{cat}</button>
      ))}
    </div>
  </section>

  <!-- Posts Grid -->
  <section class="container blog-grid-section">
    <div class="blog-grid">
      {sortedPosts.map((post: any) => (
        <article class="blog-card" data-category={post.category}>
          <a href={`/blog/${post.slug}`} class="blog-card-link">
            <div class="blog-card-image-wrap">
              <img src={post.image} alt={post.title} class="blog-card-image" loading="lazy" />
              <span class="blog-card-category">{post.category}</span>
            </div>
            <div class="blog-card-body">
              <div class="blog-card-meta">
                <span>{new Date(post.date).toLocaleDateString('en-AU', { day: 'numeric', month: 'short', year: 'numeric' })}</span>
                <span class="blog-meta-dot">·</span>
                <span>{post.readTime}</span>
              </div>
              <h2 class="blog-card-title">{post.title}</h2>
              <p class="blog-card-excerpt">{post.excerpt}</p>
              <div class="blog-card-tags">
                {post.tags.slice(0, 3).map((tag: string) => (
                  <span class="blog-tag">{tag}</span>
                ))}
              </div>
            </div>
          </a>
        </article>
      ))}
    </div>
  </section>

  <!-- CTA -->
  <section class="blog-cta-section">
    <div class="container">
      <div class="blog-cta-box">
        <h2 class="font-display" style="font-size:1.3rem;color:var(--color-text);margin-bottom:0.5rem;">Need Help Choosing?</h2>
        <p style="color:var(--color-text-secondary);font-size:0.88rem;margin-bottom:1.25rem;">Our team at Vapelink is always happy to help. Visit our store in Coburg, Melbourne or get in touch.</p>
        <div style="display:flex;gap:0.75rem;flex-wrap:wrap;justify-content:center;">
          <a href="/collections/shop" class="btn-primary" style="padding:0.7rem 1.75rem;">Shop Now</a>
          <a href="/pages/contact-us" class="btn-secondary" style="padding:0.7rem 1.75rem;">Contact Us</a>
        </div>
      </div>
    </div>
  </section>

  <script>
    document.querySelectorAll('.blog-filter-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.blog-filter-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        const cat = btn.getAttribute('data-category');
        document.querySelectorAll('.blog-card').forEach(card => {
          const el = card as HTMLElement;
          if (cat === 'all' || el.dataset.category === cat) {
            el.style.display = '';
          } else {
            el.style.display = 'none';
          }
        });
      });
    });
  </script>
</Layout>

<style is:global>
  .breadcrumb-bar { background: var(--color-surface); border-bottom: 1px solid var(--color-border); padding: 0.85rem 0; }
  .breadcrumb { display: flex; align-items: center; gap: 0.45rem; flex-wrap: wrap; font-size: 0.8rem; list-style: none; }
  .breadcrumb a { color: var(--color-text-secondary); text-decoration: none; transition: color 0.15s ease; }
  .breadcrumb a:hover { color: var(--color-accent); }
  .breadcrumb svg { color: var(--color-text-dim); }
  .breadcrumb-current { color: var(--color-text); font-weight: 500; }

  .blog-hero {
    padding: 3rem 0 2rem;
    text-align: center;
  }
  .blog-hero-title {
    font-size: 2rem;
    font-weight: 700;
    color: var(--color-text);
    margin-top: 0.25rem;
    margin-bottom: 0.6rem;
  }
  .blog-hero-desc {
    color: var(--color-text-secondary);
    font-size: 1rem;
    max-width: 500px;
    margin: 0 auto;
  }

  .blog-filter-section { padding: 0 0 1.5rem; }
  .blog-filters {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
    justify-content: center;
  }
  .blog-filter-btn {
    padding: 0.4rem 1rem;
    font-family: 'Space Grotesk', sans-serif;
    font-size: 0.78rem;
    font-weight: 600;
    color: var(--color-text-secondary);
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-full);
    cursor: pointer;
    transition: all 0.15s ease;
  }
  .blog-filter-btn:hover {
    border-color: var(--color-border-hover);
    color: var(--color-text);
  }
  .blog-filter-btn.active {
    background: var(--color-accent);
    color: #fff;
    border-color: var(--color-accent);
  }

  .blog-grid-section { padding-bottom: 3rem; }
  .blog-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 1.25rem;
  }
  @media (min-width: 640px) { .blog-grid { grid-template-columns: repeat(2, 1fr); } }
  @media (min-width: 1024px) { .blog-grid { grid-template-columns: repeat(3, 1fr); } }

  .blog-card {
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    overflow: hidden;
    transition: border-color 0.15s ease, box-shadow 0.15s ease;
  }
  .blog-card:hover {
    border-color: var(--color-border-hover);
    box-shadow: var(--shadow-md);
  }
  .blog-card-link {
    text-decoration: none;
    color: inherit;
    display: flex;
    flex-direction: column;
    height: 100%;
  }
  .blog-card-image-wrap {
    position: relative;
    aspect-ratio: 16/9;
    overflow: hidden;
    background: var(--color-surface-alt);
  }
  .blog-card-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }
  .blog-card-category {
    position: absolute;
    top: 0.65rem;
    left: 0.65rem;
    padding: 0.2rem 0.6rem;
    font-family: 'Space Grotesk', sans-serif;
    font-size: 0.65rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: #fff;
    background: var(--color-accent);
    border-radius: var(--radius-sm);
  }
  .blog-card-body {
    flex: 1;
    padding: 1rem;
    display: flex;
    flex-direction: column;
  }
  .blog-card-meta {
    display: flex;
    align-items: center;
    gap: 0.35rem;
    font-size: 0.72rem;
    color: var(--color-text-muted);
    margin-bottom: 0.5rem;
  }
  .blog-meta-dot { color: var(--color-text-dim); }
  .blog-card-title {
    font-family: 'Inter', sans-serif;
    font-size: 0.95rem;
    font-weight: 700;
    color: var(--color-text);
    line-height: 1.3;
    margin-bottom: 0.45rem;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  .blog-card-excerpt {
    font-size: 0.82rem;
    color: var(--color-text-secondary);
    line-height: 1.55;
    flex: 1;
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
    margin-bottom: 0.75rem;
  }
  .blog-card-tags {
    display: flex;
    gap: 0.3rem;
    flex-wrap: wrap;
  }
  .blog-tag {
    padding: 0.15rem 0.5rem;
    font-size: 0.65rem;
    color: var(--color-text-muted);
    background: var(--color-surface-alt);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-full);
  }

  .blog-cta-section {
    padding: 0 0 4rem;
  }
  .blog-cta-box {
    background: var(--color-surface-alt);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: 2.5rem;
    text-align: center;
  }
</style>
